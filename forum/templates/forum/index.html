<!DOCTYPE html>
<html lang="en">
<head>
    <title>Index of forum</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width-device-width, initla-scale-1.0">
    {% load staticfiles %} {# jinja logic to reference static files #}
    <link rel='stylesheet' href="{% static 'forum/css/bootstrap.min.css' %}" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="{% static 'forum/js/bootstrap.min.js' %}"></script>
</head>
<body class="body" style="background-color: #f6f6f6">


<div class="container-fluid">
    <h1>Current subject: {{ topic_name }}</h1>
    {% if latest_questions_list %}
        <div class="panel-group" id="accordion">
            {% for q in latest_questions_list %}
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ forloop.counter }}">
                                <div class="row">
                                    <div class="col-md-6">{{ q.question_name }}</div>
                                    <div class="col-md-6">Created: {{ q.question_created }}</div>
                                </div>
                            </a>
                        </h4>
                    </div>
                    <div id="collapse{{ forloop.counter }}" class="panel-collapse collapse">
                        <div class="panel-body">
                            <p>{{ q.question_text }}</p>
                            <p>{{ q.answers.answer_text }}</p>
                            <br>
                            {% for answer in answer_list %}
                                {% if answer.question_id == q.id %}
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="row">
                                                <div class="col-md-6">Placeholder for username</div>
                                                <div class="col-md-6">Created: {{ answer.answer_created }}</div>
                                            </div>
                                        </div>
                                        <div class="panel-body">
                                            {{ answer.answer_text }}
                                        </div>
                                    </div>
                                    <br>
                                {% endif %}
                            {% endfor %}
                            <form class="new_question" action="/forum/new_answer/" method='post'>
                                {% csrf_token %}
                                {{ form.answer_text }}
                                <input type="hidden" value="{{ q.id }}" name="question">
                                {{ form.topic.as_hidden }}
                                <br><input type='submit' class="btn btn-default" value='Submit'/>
                            </form>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No questions are available.</p>
    {% endif %}
    <a class="btn btn-default" href="new_question" role="button">Create new question</a>
    <br>
    <br>
    <a class="btn btn-default" href="/forum" role="button">Go back</a>
</div>

</body>
</html>
